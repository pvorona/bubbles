<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Force Layout</title>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.5.0/d3.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-force/1.1.0/d3-force.js"></script>

    <style>
        .circle {
            fill: #D31B26;
            /*animation: a-main 1s;*/
            /*transition: transform .2s;*/
        }

        .main {
        }

        @keyframes a-main {
            from {
                fill: transparent;
            }
            to {
                fill: #D31B26;
            }
        }
    </style>

    <svg width="1240" height="800">

        <defs>
          <filter id="goo">
              <feGaussianBlur in="SourceGraphic" result="blur" stdDeviation="20" />
              <!-- <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 200 -70" result="goo" /> -->
              <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 200 -90" result="goo" />
              <!-- <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 50 -30" result="goo" /> -->
              <feBlend in2="goo" in="SourceGraphic" result="mix" />
          </filter>
        </defs>

        <g id="bubbles" style="filter: url(#goo);">
            <circle r="90"  class="circle" />
            <circle r="100" class="circle" />
            <circle r="140" class="circle main" />
            <circle r="70"  class="circle" />
            <circle r="30"  class="circle" />
            <circle r="40"  class="circle" />
            <circle r="20"  class="circle" />
            <circle r="60"  class="circle" />
        </g>
    </svg>
    <script>
        nodes = [
            { x:  1240 / 2 - 200, y:  800 / 2, r: 90},
            { x:  1240 / 2 - 200, y:  800 / 2, r: 100},
            { fx: 1240 / 2 - 200, fy: 800 / 2, r: 140},
            { x:  1240 / 2 - 200, y:  800 / 2, r: 70},
            { x:  1240 / 2 - 200, y:  800 / 2, r: 30},
            { x:  1240 / 2 - 200, y:  800 / 2, r: 40},
            { x:  1240 / 2 - 200, y:  800 / 2, r: 20},
            { x:  1240 / 2 - 200, y:  800 / 2, r: 60},
        ]

        links = [
            { source: 2, target: 0 },
            { source: 2, target: 1 },
            { source: 2, target: 3 },
            { source: 2, target: 4 },
            { source: 2, target: 5 },
            { source: 2, target: 6 },
            { source: 2, target: 7 },
        ]

        var node = d3
            .selectAll('circle')
            .data(nodes)

        var simulation = d3.forceSimulation(nodes)
            .force('center', d3.forceCenter(1240 / 2 - 200, 800 / 2))
            // .force("charge", d3.forceManyBody().strength(d => -d.r * 50)) //if many little bubbles
            .force("charge", d3.forceManyBody().strength(-1000))
            .force("link", d3.forceLink(links).distance(link => link.source.r + link.target.r + 35))
            .force('collide', d3.forceCollide(d => d.r + 20))
            .alphaTarget(1)
            .velocityDecay(0.92)
            // .alphaDecay(1 - Math.pow(0.001, 1 / 100)) // 1 - Math.pow(0.001, 1 / 100)
            .on('tick', ticked);

          function ticked () {
            node.attr('transform', d => `translate(${d.x},${d.y})`);
          }

          var i = 7
          var linkIndex = 6
          function addOne () {
            const index = ++i
            const r = Math.random() * 100

            var svg = document.getElementsByTagName('svg')[0]; //Get svg element
            var newElement = document.createElementNS("http://www.w3.org/2000/svg", 'circle'); //Create a path in SVG's namespace
            newElement.setAttribute("r",r); //Set path's data
            newElement.classList.add('circle')
            bubbles.appendChild(newElement);
            const newNode = { x: 1240 / 2, y: 800 / 2, vx: 0, vy: 0, index, r}

            nodes.push(
                newNode
            )
            // links.push(
                // { source: nodes[2], target: newNode, index: ++linkIndex },
            // )
            node = d3
                .selectAll('circle')
                .data(nodes)

            simulation.restart()
          }
    </script>
    <button onclick="addOne()">add one</button>

</body>
</html>